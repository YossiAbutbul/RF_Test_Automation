# ---------- Compatibility keys for split runners (added, nothing removed) ----------
defaults:
  spectrum:
    marker: "MARK1"
    default_delay_s: 0.15

# Global analyzer reference offset (read by tests_common.get_global_analyzer_ref_offset_db)
analyzer_analyzer_ref_offset_db: 25.5  # copied from root analyzer_ref_offset_db


# ---------- All test configs live under this key (used by get_test_config) ----------
tests:
  # ===== LoRa: Tx Power =====
  tx_power:
    analyzer_setup:
      span_hz: 5000000
      rbw_hz: 300000
      vbw_hz: 1000000
      ref_level_dbm: 20.0
      use_peak_detector: true
    settle:
      after_center_s: 0.250
      after_lora_cw_on_s: 0.60

  # ===== LoRa: Frequency Accuracy (exactly 3 zooms) =====
  frequency_accuracy:
    analyzer_setup:
      span_hz: 2000000
      rbw_hz: 300000
      vbw_hz: 100000
      ref_level_dbm: 20.0
      use_peak_detector: true
    base:
      settle_after_center_s: 0.250
      settle_after_lora_cw_on_s: 0.40
    settle:
      after_center_s: 0.250
      after_lora_cw_on_s: 0.40
    zooms:
      - span_hz: 2000000
        rbw_hz: 300000
        vbw_hz: 100000
        delay_s: 0.250
      - span_hz: 200000
        rbw_hz: 10000
        vbw_hz: 300000
        delay_s: 0.250
      - span_hz: 20000
        rbw_hz: 1000
        vbw_hz: 3000
        delay_s: 0.250

  # ===== LTE: Tx Power =====
  lte_defaults:
    analyzer_setup:
      span_hz: 2000000
      rbw_hz: 300000
      vbw_hz: 100000
      ref_level_dbm: 25.0
      use_peak_detector: true
    settle_after_cw_on_s: 0.30

  # ===== LTE: Frequency Accuracy (new) =====
  lte_frequency_accuracy:
    analyzer_setup:
      span_hz: 2000000
      rbw_hz: 300000
      vbw_hz: 100000
      ref_level_dbm: 25.0
      use_peak_detector: true
    base:
      settle_after_center_s: 0.250
      settle_after_lte_modem_on_s: 0.30
      settle_after_lte_cw_on_s: 0.40
    zooms:
      - span_hz: 2000000
        rbw_hz: 300000
        vbw_hz: 100000
        delay_s: 0.250
      - span_hz: 200000
        rbw_hz: 10000
        vbw_hz: 300000
        delay_s: 0.250
      - span_hz: 20000
        rbw_hz: 1000
        vbw_hz: 3000
        delay_s: 0.250

  # ===== LTE: EARFCN → Frequency (Hz) map =====
  lte_earfcn_map:
    # EARFCN → Frequency (Hz) mappings for Band 12
    23035: 701500000   # 701.5 MHz
    23095: 707500000   # 707.5 MHz
    23155: 713500000   # 713.5 MHz

    # EARFCN → Frequency (Hz) mappings for Band 4
    20000: 1715000000  # 1715 MHz
    20175: 1732500000  # 1732.5 MHz
    20350: 1750000000  # 1750 MHz

    # EARFCN → Frequency (Hz) mappings for Band 2
    18650: 1855000000  # 1855 MHz
    18900: 1880000000  # 1880 MHz
    19150: 1905000000  # 1905 MHz

  # ===== BLE: Tx Power =====
  ble_defaults:
    settle_after_power_set_s: 0.30
    settle_after_test_tone_s: 0.50

  ble_tx_power:
    simple_cw_mode: true
    duration_s: 6.0
    tone_settle_s: 0.30
    measure_settle_s: 0.12
    offset_hz: 0
    reconnect_attempts: 2
    analyzer_setup:
      span_hz: 5000000
      rbw_hz: 100000
      vbw_hz: 100000
      ref_level_dbm: 0
    settle:
      after_center_s: 0.25

  # ===== BLE: Frequency Accuracy (new, 3 zooms like LoRa) =====
  ble_frequency_accuracy:
    analyzer_setup:
      span_hz: 2000000
      rbw_hz: 300000
      vbw_hz: 100000
      ref_level_dbm: 20.0
      use_peak_detector: true
    after_center_s: 0.250
    tone_duration_ms: 15000
    offset_hz: 0
    measure_settle_s: 0.10
    zoom_delay_s: 0.250
    zooms:
      - span_hz: 2000000
        rbw_hz: 300000
        vbw_hz: 100000
        delay_s: 0.250
      - span_hz: 200000
        rbw_hz: 10000
        vbw_hz: 300000
        delay_s: 0.250
      - span_hz: 20000
        rbw_hz: 1000
        vbw_hz: 3000
        delay_s: 0.250
